# 06. Git運用

## 概要

本規約は、Gitによるバージョン管理の運用ルールを定める。
ブランチ戦略、PR運用、コミットメッセージ規約を含む。

---

## ブランチ戦略

### ブランチ構成

```
main          # 本番リリース用（安定版）
  ↑
dev           # 開発用（統合ブランチ）
  ↑
├── maikuma   # 個人ブランチ
├── sekishiro # 個人ブランチ
├── seiwan    # 個人ブランチ
└── ...
```

### ブランチの役割

| ブランチ | 役割 | マージ元 | マージ先 |
|---------|------|---------|---------|
| `main` | 本番環境用、安定版 | `dev` | - |
| `dev` | 開発統合ブランチ | 個人ブランチ | `main` |
| 個人ブランチ | 各開発者の作業用 | `dev` | `dev` |

### ブランチの命名規則

- **個人ブランチ**: 自分の名前をそのまま使用（例: `maikuma`, `sekishiro`）
- **機能ブランチ**: 必要に応じて `feature/{機能名}` 形式も可

```bash
# 個人ブランチの作成
git checkout dev
git checkout -b maikuma

# 機能ブランチの作成（オプション）
git checkout dev
git checkout -b feature/add-llm-chat
```

---

## 日常の開発フロー

### 1. 作業開始

```bash
# devから最新を取得
git checkout dev
git pull origin dev

# 個人ブランチに切り替え
git checkout maikuma

# devの変更を取り込む
git merge dev
```

### 2. 作業中

```bash
# 変更をコミット
git add .
git commit -m "Add: LLMチャット機能の実装"

# リモートにプッシュ
git push origin maikuma
```

### 3. 区切りのいいタイミング

```bash
# PRを作成（GitHub上で）
# dev ← maikuma のPRを作成
```

---

## PR（Pull Request）運用

### PRを作成するタイミング

- 機能の実装が一段落したとき
- レビューを受けたいとき
- 週に1回程度の定期的なマージ

### PRの作成方法

1. GitHub上で「New Pull Request」をクリック
2. base: `dev` ← compare: `個人ブランチ` を選択
3. タイトルと説明を記載
4. レビュアーをアサイン（必要に応じて）

### PRテンプレート

```markdown
## 概要
<!-- 変更の概要を記載 -->

## 変更内容
- [ ] 機能A の実装
- [ ] 機能B の修正

## 確認事項
- [ ] テストが通ること
- [ ] ドキュメントを更新したこと

## 関連Issue
<!-- 関連するIssue番号があれば記載 -->
```

### レビューとマージ

- レビューは必須ではないが、重要な変更は他メンバーに確認を依頼
- 特に問題がなければ、作成者自身がマージしても可
- `dev` → `main` のマージは maikuma が担当

---

## コミットメッセージ規約

### 基本形式

```
{タイプ}: {変更の要約}

{詳細な説明（オプション）}
```

### タイプの種類

| タイプ | 用途 |
|-------|------|
| `Add` | 新機能の追加 |
| `Fix` | バグ修正 |
| `Update` | 既存機能の更新・改善 |
| `Remove` | 機能・ファイルの削除 |
| `Refactor` | リファクタリング（機能変更なし） |
| `Docs` | ドキュメントのみの変更 |
| `Test` | テストの追加・修正 |
| `Chore` | ビルド設定、依存関係の更新など |

### 例

```bash
# 新機能追加
git commit -m "Add: Irisデータの予測機能を追加"

# バグ修正
git commit -m "Fix: 画像アップロード時のエラーを修正"

# ドキュメント更新
git commit -m "Docs: 開発規約を更新"

# 詳細な説明が必要な場合
git commit -m "Refactor: データ処理ロジックを分離

- DataProcessorクラスを新規作成
- 既存のprocess_data関数を移行
- テストを追加"
```

### 注意点

- 1行目は50文字以内を目安
- 日本語でも英語でも可
- 何を変更したかではなく、なぜ変更したかを意識する

---

## Git管理対象

### 管理に含めるもの

- ソースコード（`src/`, `tests/`）
- ドキュメント（`docs/`）
- 設定ファイル（`.github/`, `pyproject.toml` など）
- 小容量のデータファイル

### 管理に含めないもの

- 機密情報（`.env`）
- 大容量データ、学習済みモデル
- 二次データ、一時データ
- 個人用ドキュメントフォルダ

※ データの詳細は [03_データ管理.md](./03_データ管理.md) を参照

---