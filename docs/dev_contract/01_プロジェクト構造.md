# 01. プロジェクト構造

## 概要

本プロジェクトは、アプリケーション開発と学習・実験の両方の目的を持つ。
そのため、本番コードと実験コードを明確に分離するフォルダ構造を採用する。

---

## フォルダの役割

### 本番コード

| フォルダ | 役割 | 配置するもの |
|---------|------|-------------|
| `core/` | 中核ロジック | ビジネスロジック、ドメインモデル |
| `models/` | モデル定義 | MLモデル、データクラス、Pydanticモデル |
| `utils/` | ユーティリティ | 汎用的なヘルパー関数・クラス |
| `services/` | サービス層 | 外部APIとの連携、データ処理 |
| `server/` | サーバー | Flask/Streamlitアプリ |
| `entry/` | エントリポイント | アプリケーションの起動スクリプト |

### 実験・サンプルコード

| フォルダ | 役割 | 配置するもの |
|---------|------|-------------|
| `experiments/` | 実験用 | ライブラリの検証、新機能のプロトタイプ、学習用スクリプト |
| `examples/` | サンプル | 本番コードの使い方を示すデモスクリプト |

#### experiments/ と examples/ の使い分け

```
experiments/
├── langchain_test.py       # LangChainを試してみる
├── new_model_prototype.py  # 新モデルの実験
└── performance_check.py    # パフォーマンス検証

examples/
├── iris_prediction.py      # Irisサービスの使い方
├── image_processing.py     # 画像処理機能の使い方
└── api_usage.py           # API利用のサンプル
```

> **ポイント**: `experiments/` は「試行錯誤」、`examples/` は「使い方のデモ」という違いがある。
> `experiments/` のコードは品質を問わないが、`examples/` は他者が参考にするため一定の品質を保つ。

---

## 設定ファイルの配置ルール

### パス管理

- パス関連の定義は `src/config/paths.py` で一元管理する
- ハードコードされたパスは避け、必ず `paths.py` を経由する

```python
# Good
from src.config.paths import DATA_DIR
file_path = DATA_DIR / "input.csv"

# Bad
file_path = "/Users/xxx/project/data/input.csv"
```

### 秘密情報

- APIキーなどの機密情報はルート直下の `.env` に記載
- `src/config/load_setting.py` で読み込む
- `.env` はGit管理に含めない（`.gitignore` に追加済み）

```bash
# .env
OPENAI_API_KEY=sk-xxxxx
DATABASE_URL=postgresql://...
```

### 機械学習関連の設定

- サービス・機能単位で `config/` フォルダを作成
- YAMLなどの設定ファイルはGit管理から除外
- 設定を読み込むLoaderクラスのみGit管理する

```
src/ml/image/
├── config/
│   ├── model_config.yaml      # Git管理外
│   └── config_loader.py       # Git管理対象
└── ...
```

---