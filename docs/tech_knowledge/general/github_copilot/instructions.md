# GitHub Copilot Instructions機能

Instructionsは、Copilotに常時適用される指示を定義する機能です。

---

## 📖 概要

### Instructionsとは

Instructionsは、すべてのCopilot操作に自動的に適用される指示です：

- **グローバル指示**: リポジトリ全体に適用
- **フォルダ単位の指示**: 特定ディレクトリに適用
- **ファイルパターンの指示**: 特定のファイルタイプに適用

### 用途

- プロジェクト共通のコーディングスタイル指定
- 使用言語・フレームワークの明示
- 禁止事項の定義
- 出力形式の統一

---

## 📁 ファイル仕様

### グローバル指示

リポジトリ全体に適用される指示ファイル：

```
.github/copilot-instructions.md
```

### フォルダ・パターン単位の指示

特定の条件に適用される指示ファイル：

```
.github/instructions/
└── {instruction-name}.instruction.md
```

### フロントマター

```yaml
---
applyTo: "**/*.py"  # 適用対象のglobパターン
---
```

| フィールド | 必須 | 説明 |
|-----------|------|------|
| `applyTo` | ❌ | 適用対象のファイルパターン（glob形式） |

---

## 📝 ファイル例

### グローバル指示

```markdown
<!-- .github/copilot-instructions.md -->

# プロジェクト共通の指示

## コーディングスタイル
- Python 3.11以上を使用
- PEP 8に準拠
- 型ヒントを必ず付ける
- docstringはGoogle形式

## 禁止事項
- printデバッグ（loggingを使用）
- ハードコードされた秘密情報
- グローバル変数の使用

## フレームワーク
- Backend: Flask
- Frontend: React
- Database: SQLite
```

### Pythonファイル向け指示

```markdown
<!-- .github/instructions/python.instruction.md -->
---
applyTo: "**/*.py"
---

# Pythonファイル向けの指示

- pytestでテストを記述
- 関数は30行以内に収める
- 循環的複雑度は10以下
```

### テストファイル向け指示

```markdown
<!-- .github/instructions/tests.instruction.md -->
---
applyTo: "tests/**/*.py"
---

# テストファイル向けの指示

- pytestのフィクスチャを活用
- モックはunittest.mockを使用
- テスト関数名は test_{対象}_{条件}_{期待結果} 形式
```

---

## ⚠️ 注意事項

### コンテキストの肥大化

Instructionsは**毎回のリクエストに自動で追加**されるため、以下の点に注意が必要です：

1. **トークン消費**: 指示が長いほど、各リクエストのトークン消費が増加
2. **コンテキスト圧迫**: 長い指示は、コードコンテキストを圧迫
3. **応答速度**: 処理するテキストが増えるため、応答が遅くなる可能性

### ベストプラクティス

- **最小限に**: 本当に毎回必要な指示のみを記述
- **エージェント/プロンプトとの使い分け**: タスク固有の指示はエージェント・プロンプトで定義
- **定期的な見直し**: 不要になった指示は削除

---

## ❌ 本プロジェクトでの方針

> **本プロジェクトでは Instructions機能を使用しません**

### 理由

1. **コンテキストの肥大化防止**: 毎回適用されるプロンプトは最小限に抑えるべき
2. **明示的な制御**: エージェント・プロンプトで明示的にコンテキストを制御
3. **柔軟性の確保**: タスクごとに最適なコンテキストを与える

### 代替手段

- **エージェント**: 役割ごとに特化したコンテキストを定義
- **プロンプト**: タスクごとに必要な指示をテンプレート化
- **タスクファイル**: プロンプトから参照する詳細な指示を別ファイルに分離

---

## 📚 関連ドキュメント

- [GitHub Copilot 概要](./README.md)
- [エージェント機能](./agents.md)
- [プロンプト機能](./prompts.md)
